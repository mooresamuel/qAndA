{"ast":null,"code":"var _jsxFileName = \"/home/samoore/tpd/new/src/pages/EndExerciseChat.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport { createChatContext, fetchAIEndExerciseAnswers } from \"../services/AIChatAPI\";\nimport FullPageSpinner from \"../components/FullPageSpinner/FullPageSpinner\";\nimport { useExerciseData } from \"../Contexts/ExerciseContext\";\nimport ChatQuestionRecording from \"../components/ChatQuestionRecording/ChatQuestionRecording\";\nimport ChatBubble from \"../components/ChatBubble/ChatBubble\";\nimport ChatWaitingIndicator from \"../components/ChatWaitingIndicator/ChatWaitingIndicator\";\nimport AcceptGeneratedExercises from \"../components/AcceptGeneratedExercises/AcceptGeneratedExercises\";\nimport SpokenText from \"../components/SpokenText/SpokenText\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction EndExerciseChat() {\n  _s();\n  const navigate = useNavigate();\n  const {\n    mistakes,\n    handleUseGeneratedQuestions\n  } = useExerciseData();\n  const [chat, setChat] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isSending, setIsSending] = useState(false);\n  const [displayAcceptQuestions, setDisplayAcceptQuestions] = useState(false);\n  const [generatedQuestions, setGeneratedQuestions] = useState(null);\n  useEffect(function () {\n    async function fetch() {\n      if (chat.length !== 0) return;\n      await createChatContext();\n      const data = await fetchAIEndExerciseAnswers({\n        exercise_details: mistakes,\n        message: \"Please evaluate this exercise\"\n      });\n      console.log(data);\n      setChat(current => [...current, {\n        sent: \"bot\",\n        message: data.response\n      }]);\n      if (data.includes_questions) {\n        setDisplayAcceptQuestions(true);\n        console.log(\"data.question\", data.question);\n        setGeneratedQuestions(data.question);\n      } else {\n        setDisplayAcceptQuestions(false);\n        setGeneratedQuestions(data.question);\n      }\n      setIsLoading(false);\n    }\n    fetch();\n  }, [chat]);\n  async function handleSend(user_input) {\n    setIsSending(true);\n    setChat(chat => [...chat, {\n      sent: \"user\",\n      message: user_input\n    }]);\n    try {\n      const prompt = {\n        exercise_details: mistakes,\n        message: user_input\n      };\n      const data = await fetchAIEndExerciseAnswers(prompt);\n      setChat(chat => [...chat, {\n        sent: \"bot\",\n        message: data.response\n      }]);\n    } catch (err) {\n      console.log(err);\n    } finally {\n      setIsSending(false);\n    }\n  }\n  if (isLoading) return /*#__PURE__*/_jsxDEV(FullPageSpinner, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 25\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col justify-between h-full py-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(SpokenText, {\n        containerClass: \"items-center text-3xl\",\n        text: \"Review your performance\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-grow bg-white flex flex-col gap-3 py-4 px-3 overflow-y-auto\",\n      children: [chat.map((message, i) => /*#__PURE__*/_jsxDEV(ChatBubble, {\n        message: message\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this)), isSending && /*#__PURE__*/_jsxDEV(ChatWaitingIndicator, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 23\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pb-4\",\n      children: displayAcceptQuestions ? /*#__PURE__*/_jsxDEV(AcceptGeneratedExercises, {\n        onAccept: () => handleUseGeneratedQuestions(generatedQuestions),\n        onChatbot: () => setDisplayAcceptQuestions(false)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(ChatQuestionRecording, {\n          onSend: handleSend\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \" flex gap-3 justify-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => navigate(\"/\"),\n            className: \"border-1 rounded-md text-hightlight font-semibold border-hightlight px-4 py-2 w-fit hover:text-white hover:bg-hightlight\",\n            children: \"Leave\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 15\n          }, this), generatedQuestions && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleUseGeneratedQuestions(generatedQuestions),\n            className: \"border-1 rounded-md bg-hightlight text-white  font-semibold border-hightlight px-4 py-2 w-fit\",\n            children: \"Practice more\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n}\n_s(EndExerciseChat, \"QWHnoi4EvbwPtGuc4I6oOKltpps=\", false, function () {\n  return [useNavigate, useExerciseData];\n});\n_c = EndExerciseChat;\nexport default EndExerciseChat;\nvar _c;\n$RefreshReg$(_c, \"EndExerciseChat\");","map":{"version":3,"names":["useEffect","useState","createChatContext","fetchAIEndExerciseAnswers","FullPageSpinner","useExerciseData","ChatQuestionRecording","ChatBubble","ChatWaitingIndicator","AcceptGeneratedExercises","SpokenText","useNavigate","jsxDEV","_jsxDEV","EndExerciseChat","_s","navigate","mistakes","handleUseGeneratedQuestions","chat","setChat","isLoading","setIsLoading","isSending","setIsSending","displayAcceptQuestions","setDisplayAcceptQuestions","generatedQuestions","setGeneratedQuestions","fetch","length","data","exercise_details","message","console","log","current","sent","response","includes_questions","question","handleSend","user_input","prompt","err","fileName","_jsxFileName","lineNumber","columnNumber","className","children","containerClass","text","map","i","onAccept","onChatbot","onSend","onClick","_c","$RefreshReg$"],"sources":["/home/samoore/tpd/new/src/pages/EndExerciseChat.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport {\r\n  createChatContext,\r\n  fetchAIEndExerciseAnswers,\r\n} from \"../services/AIChatAPI\";\r\nimport FullPageSpinner from \"../components/FullPageSpinner/FullPageSpinner\";\r\nimport { useExerciseData } from \"../Contexts/ExerciseContext\";\r\nimport ChatQuestionRecording from \"../components/ChatQuestionRecording/ChatQuestionRecording\";\r\nimport ChatBubble from \"../components/ChatBubble/ChatBubble\";\r\nimport ChatWaitingIndicator from \"../components/ChatWaitingIndicator/ChatWaitingIndicator\";\r\nimport AcceptGeneratedExercises from \"../components/AcceptGeneratedExercises/AcceptGeneratedExercises\";\r\nimport SpokenText from \"../components/SpokenText/SpokenText\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nfunction EndExerciseChat() {\r\n  const navigate = useNavigate();\r\n  const { mistakes, handleUseGeneratedQuestions } = useExerciseData();\r\n  const [chat, setChat] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [isSending, setIsSending] = useState(false);\r\n  const [displayAcceptQuestions, setDisplayAcceptQuestions] = useState(false);\r\n  const [generatedQuestions, setGeneratedQuestions] = useState(null);\r\n\r\n  useEffect(\r\n    function () {\r\n      async function fetch() {\r\n        if (chat.length !== 0) return;\r\n        await createChatContext();\r\n        const data = await fetchAIEndExerciseAnswers({\r\n          exercise_details: mistakes,\r\n          message: \"Please evaluate this exercise\",\r\n        });\r\n\r\n        console.log(data);\r\n        setChat((current) => [\r\n          ...current,\r\n          { sent: \"bot\", message: data.response },\r\n        ]);\r\n        if (data.includes_questions) {\r\n          setDisplayAcceptQuestions(true);\r\n          console.log(\"data.question\", data.question);\r\n          setGeneratedQuestions(data.question);\r\n        } else {\r\n          setDisplayAcceptQuestions(false);\r\n          setGeneratedQuestions(data.question);\r\n        }\r\n        setIsLoading(false);\r\n      }\r\n      fetch();\r\n    },\r\n    [chat]\r\n  );\r\n\r\n  async function handleSend(user_input) {\r\n    setIsSending(true);\r\n    setChat((chat) => [...chat, { sent: \"user\", message: user_input }]);\r\n    try {\r\n      const prompt = {\r\n        exercise_details: mistakes,\r\n        message: user_input,\r\n      };\r\n\r\n      const data = await fetchAIEndExerciseAnswers(prompt);\r\n      setChat((chat) => [...chat, { sent: \"bot\", message: data.response }]);\r\n    } catch (err) {\r\n      console.log(err);\r\n    } finally {\r\n      setIsSending(false);\r\n    }\r\n  }\r\n\r\n  if (isLoading) return <FullPageSpinner />;\r\n\r\n  return (\r\n    <div className=\"flex flex-col justify-between h-full py-4\">\r\n      <div>\r\n        <SpokenText\r\n          containerClass={\"items-center text-3xl\"}\r\n          text={\"Review your performance\"}\r\n        />\r\n      </div>\r\n      <div className=\"flex-grow bg-white flex flex-col gap-3 py-4 px-3 overflow-y-auto\">\r\n        {chat.map((message, i) => (\r\n          <ChatBubble message={message} key={i} />\r\n        ))}\r\n\r\n        {isSending && <ChatWaitingIndicator />}\r\n      </div>\r\n      <div className=\"pb-4\">\r\n        {displayAcceptQuestions ? (\r\n          <AcceptGeneratedExercises\r\n            onAccept={() => handleUseGeneratedQuestions(generatedQuestions)}\r\n            onChatbot={() => setDisplayAcceptQuestions(false)}\r\n          />\r\n        ) : (\r\n          <div className=\"flex flex-col gap-2\">\r\n            <ChatQuestionRecording onSend={handleSend} />\r\n            <div className=\" flex gap-3 justify-center\">\r\n              <button\r\n                onClick={() => navigate(\"/\")}\r\n                className=\"border-1 rounded-md text-hightlight font-semibold border-hightlight px-4 py-2 w-fit hover:text-white hover:bg-hightlight\"\r\n              >\r\n                Leave\r\n              </button>\r\n              {generatedQuestions && (\r\n                <button\r\n                  onClick={() =>\r\n                    handleUseGeneratedQuestions(generatedQuestions)\r\n                  }\r\n                  className=\"border-1 rounded-md bg-hightlight text-white  font-semibold border-hightlight px-4 py-2 w-fit\"\r\n                >\r\n                  Practice more\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default EndExerciseChat;\r\n"],"mappings":";;AAAA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,SACEC,iBAAiB,EACjBC,yBAAyB,QACpB,uBAAuB;AAC9B,OAAOC,eAAe,MAAM,+CAA+C;AAC3E,SAASC,eAAe,QAAQ,6BAA6B;AAC7D,OAAOC,qBAAqB,MAAM,2DAA2D;AAC7F,OAAOC,UAAU,MAAM,qCAAqC;AAC5D,OAAOC,oBAAoB,MAAM,yDAAyD;AAC1F,OAAOC,wBAAwB,MAAM,iEAAiE;AACtG,OAAOC,UAAU,MAAM,qCAAqC;AAC5D,SAASC,WAAW,QAAQ,kBAAkB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE/C,SAASC,eAAeA,CAAA,EAAG;EAAAC,EAAA;EACzB,MAAMC,QAAQ,GAAGL,WAAW,CAAC,CAAC;EAC9B,MAAM;IAAEM,QAAQ;IAAEC;EAA4B,CAAC,GAAGb,eAAe,CAAC,CAAC;EACnE,MAAM,CAACc,IAAI,EAAEC,OAAO,CAAC,GAAGnB,QAAQ,CAAC,EAAE,CAAC;EACpC,MAAM,CAACoB,SAAS,EAAEC,YAAY,CAAC,GAAGrB,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAACsB,SAAS,EAAEC,YAAY,CAAC,GAAGvB,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACwB,sBAAsB,EAAEC,yBAAyB,CAAC,GAAGzB,QAAQ,CAAC,KAAK,CAAC;EAC3E,MAAM,CAAC0B,kBAAkB,EAAEC,qBAAqB,CAAC,GAAG3B,QAAQ,CAAC,IAAI,CAAC;EAElED,SAAS,CACP,YAAY;IACV,eAAe6B,KAAKA,CAAA,EAAG;MACrB,IAAIV,IAAI,CAACW,MAAM,KAAK,CAAC,EAAE;MACvB,MAAM5B,iBAAiB,CAAC,CAAC;MACzB,MAAM6B,IAAI,GAAG,MAAM5B,yBAAyB,CAAC;QAC3C6B,gBAAgB,EAAEf,QAAQ;QAC1BgB,OAAO,EAAE;MACX,CAAC,CAAC;MAEFC,OAAO,CAACC,GAAG,CAACJ,IAAI,CAAC;MACjBX,OAAO,CAAEgB,OAAO,IAAK,CACnB,GAAGA,OAAO,EACV;QAAEC,IAAI,EAAE,KAAK;QAAEJ,OAAO,EAAEF,IAAI,CAACO;MAAS,CAAC,CACxC,CAAC;MACF,IAAIP,IAAI,CAACQ,kBAAkB,EAAE;QAC3Bb,yBAAyB,CAAC,IAAI,CAAC;QAC/BQ,OAAO,CAACC,GAAG,CAAC,eAAe,EAAEJ,IAAI,CAACS,QAAQ,CAAC;QAC3CZ,qBAAqB,CAACG,IAAI,CAACS,QAAQ,CAAC;MACtC,CAAC,MAAM;QACLd,yBAAyB,CAAC,KAAK,CAAC;QAChCE,qBAAqB,CAACG,IAAI,CAACS,QAAQ,CAAC;MACtC;MACAlB,YAAY,CAAC,KAAK,CAAC;IACrB;IACAO,KAAK,CAAC,CAAC;EACT,CAAC,EACD,CAACV,IAAI,CACP,CAAC;EAED,eAAesB,UAAUA,CAACC,UAAU,EAAE;IACpClB,YAAY,CAAC,IAAI,CAAC;IAClBJ,OAAO,CAAED,IAAI,IAAK,CAAC,GAAGA,IAAI,EAAE;MAAEkB,IAAI,EAAE,MAAM;MAAEJ,OAAO,EAAES;IAAW,CAAC,CAAC,CAAC;IACnE,IAAI;MACF,MAAMC,MAAM,GAAG;QACbX,gBAAgB,EAAEf,QAAQ;QAC1BgB,OAAO,EAAES;MACX,CAAC;MAED,MAAMX,IAAI,GAAG,MAAM5B,yBAAyB,CAACwC,MAAM,CAAC;MACpDvB,OAAO,CAAED,IAAI,IAAK,CAAC,GAAGA,IAAI,EAAE;QAAEkB,IAAI,EAAE,KAAK;QAAEJ,OAAO,EAAEF,IAAI,CAACO;MAAS,CAAC,CAAC,CAAC;IACvE,CAAC,CAAC,OAAOM,GAAG,EAAE;MACZV,OAAO,CAACC,GAAG,CAACS,GAAG,CAAC;IAClB,CAAC,SAAS;MACRpB,YAAY,CAAC,KAAK,CAAC;IACrB;EACF;EAEA,IAAIH,SAAS,EAAE,oBAAOR,OAAA,CAACT,eAAe;IAAAyC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC;EAEzC,oBACEnC,OAAA;IAAKoC,SAAS,EAAC,2CAA2C;IAAAC,QAAA,gBACxDrC,OAAA;MAAAqC,QAAA,eACErC,OAAA,CAACH,UAAU;QACTyC,cAAc,EAAE,uBAAwB;QACxCC,IAAI,EAAE;MAA0B;QAAAP,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACjC;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CAAC,eACNnC,OAAA;MAAKoC,SAAS,EAAC,kEAAkE;MAAAC,QAAA,GAC9E/B,IAAI,CAACkC,GAAG,CAAC,CAACpB,OAAO,EAAEqB,CAAC,kBACnBzC,OAAA,CAACN,UAAU;QAAC0B,OAAO,EAAEA;MAAQ,GAAMqB,CAAC;QAAAT,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CACxC,CAAC,EAEDzB,SAAS,iBAAIV,OAAA,CAACL,oBAAoB;QAAAqC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACnC,CAAC,eACNnC,OAAA;MAAKoC,SAAS,EAAC,MAAM;MAAAC,QAAA,EAClBzB,sBAAsB,gBACrBZ,OAAA,CAACJ,wBAAwB;QACvB8C,QAAQ,EAAEA,CAAA,KAAMrC,2BAA2B,CAACS,kBAAkB,CAAE;QAChE6B,SAAS,EAAEA,CAAA,KAAM9B,yBAAyB,CAAC,KAAK;MAAE;QAAAmB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACnD,CAAC,gBAEFnC,OAAA;QAAKoC,SAAS,EAAC,qBAAqB;QAAAC,QAAA,gBAClCrC,OAAA,CAACP,qBAAqB;UAACmD,MAAM,EAAEhB;QAAW;UAAAI,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eAC7CnC,OAAA;UAAKoC,SAAS,EAAC,4BAA4B;UAAAC,QAAA,gBACzCrC,OAAA;YACE6C,OAAO,EAAEA,CAAA,KAAM1C,QAAQ,CAAC,GAAG,CAAE;YAC7BiC,SAAS,EAAC,0HAA0H;YAAAC,QAAA,EACrI;UAED;YAAAL,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,EACRrB,kBAAkB,iBACjBd,OAAA;YACE6C,OAAO,EAAEA,CAAA,KACPxC,2BAA2B,CAACS,kBAAkB,CAC/C;YACDsB,SAAS,EAAC,+FAA+F;YAAAC,QAAA,EAC1G;UAED;YAAAL,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CACT;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH;IACN;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAACjC,EAAA,CA1GQD,eAAe;EAAA,QACLH,WAAW,EACsBN,eAAe;AAAA;AAAAsD,EAAA,GAF1D7C,eAAe;AA4GxB,eAAeA,eAAe;AAAC,IAAA6C,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}